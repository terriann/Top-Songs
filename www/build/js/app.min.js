var Item=Backbone.Model.extend({defaults:{part1:"hello",part2:"world"}});Song=Backbone.Model.extend({defaults:{song_name:null,images:null,link:null,artist_name:null,song_preview:null},initialize:function(a){this.set({id:a.id.attributes["im:id"],song_name:a["im:name"].label,link:a.link[0].attributes.href,song_preview:a.link[1].attributes.href,artist_name:a["im:artist"].label,images:{small:a["im:image"][0].label,medium:a["im:image"][1].label,large:a["im:image"][2].label}})}});var List=Backbone.Collection.extend({model:Item});Songs=Backbone.Collection.extend({initialize:function(a,b){this.bind("add",b.view.render)}}),AppView=Backbone.View.extend({el:$("body"),initialize:function(){this.songs=new Songs(null,{view:new SongView}),this.fetchJson()},events:{},fetchJson:function(){var a=this,b="https://itunes.apple.com/us/rss/topsongs/limit=100/explicit=true/json?callback=?";$.getJSON(b,{}).done(function(b){$.each(b.feed.entry,function(b,c){console.log("item",c);var d=new Song(c);a.songs.add(d)}),$("#song-list").masonry({itemSelector:"li"})})}});var ItemView=Backbone.View.extend({tagName:"li",tplID:"item_tpl",events:{"click span.swap":"swap","click span.delete":"remove"},initialize:function(){_.bindAll(this,"render","unrender","swap","remove"),this.model.bind("change",this.render),this.model.bind("remove",this.unrender)},render:function(){var a=twig({data:$("#"+this.tplID).html()});return $(this.el).html(a.render(this.model.toJSON())),this},unrender:function(){$(this.el).remove()},swap:function(){var a={part1:this.model.get("part2"),part2:this.model.get("part1")};this.model.set(a)},remove:function(){this.model.destroy()}}),ListView=Backbone.View.extend({el:$("body"),tplID:"list_tpl",events:{"click button#add":"addItem"},initialize:function(){_.bindAll(this,"render","addItem","appendItem"),this.collection=new List,this.collection.bind("add",this.appendItem),this.counter=0,this.render()},render:function(){var a=this,b=twig({data:$("#"+this.tplID).html()});$(this.el).append(b.render()),_(this.collection.models).each(function(b){a.appendItem(b)},this)},addItem:function(){this.counter++;var a=new Item;a.set({part2:a.get("part2")+this.counter}),this.collection.add(a)},appendItem:function(a){var b=new ItemView({model:a});$("ul",this.el).append(b.render().el)}});SongView=Backbone.View.extend({el:$("body"),name2:"songview",initialize:function(){this.name="songview"},events:{},render:function(a){$("#song-list").append('<li id="song-'+a.get("id")+'"><a href="'+a.get("link")+'"><img src="'+a.get("images").large+'" class="album" /></a><div class="song">'+a.get("song_name")+'</div><div class="artist">'+a.get("artist_name")+'</div><div class="preview"></div></li>')}}),function(){Backbone.sync=function(a,b,c){c()};new AppView}(jQuery);
//# sourceMappingURL=app.js.map